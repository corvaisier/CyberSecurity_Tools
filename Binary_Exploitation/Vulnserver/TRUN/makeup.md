makeup pour vulnserver TRUN

Utilisation du script basic_fuzzer.py

Classique fuzzer, on se connecte sur l'adresse ip et le port, puis un va envoyer x fois le caractère A à la fonction TRUN, à chaque fois on ferme la fonction puis on recommence avec de plus en plus de caractères.
Quand ça crashera, il retournera le nbr de caractères envoyé avant le crash.
=> 2700 bytes
Le but est de contrôler la valeur de EIP

Pour générer le pattern il est possible d'utiliser l'outil metasploit. 3000 car on veut chercher les caractères présents dans EIP.
````
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 3000
````
L'implémenter dans l'imput du script : basic_fuzzer_step2.py



Dans immunity debugger on peut voir en haut à droite la valeur de EIP = 386F4337
Ici on va s'arrêter à la séquence mentionnée dans le -q
````
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 3000 -q 386F4337
````
Il faut donc remodifier le script : basic_fuzzer_step3.py

En le lançant, on obtient l'erreur 42424242 => on contrôle ce qui est en input dans l'EIP
La prochaine étape est de chercher les caractères ne fonctionnant pas dans ce registre.
En recherchant juste dans google bad caracters, puis en modifiant le script, pour qu'il injecte dans l'EIP tous les caractères, on pourra voir si ils s'affichent bien dans EIP.
On pourra s'en servir ensuite pour savoir comment rédiger notre shellcode.
https://www.bulbsecurity.com/finding-bad-characters-with-immunity-debugger-and-mona-py/

