``vim /usr/include/x86_64-linux-gnu/asm/unistd_64.h``
=> permet de voir l'appel système pour execve en x64 : 59


Sur x64, les arguments n'ont pas changé par rapport au x86. Le premier argument est le programme à exécuter, le second les arguments du programme et le troisième les variables d'environnement du programme.

Il n'y qu'à pointer le premier argument vers "/bin/bash" et laisser les deux arguments restants vides (NULL).

Avant d'exécuter l'appel système, le numéro de l'appel système doit être placé dans RAX, tandis que RDI, RSI et RDX contiennent les arguments à exécuter.

Par conséquent, RDI contiendra un pointeur vers "/bin/sh" et RSI contiendra un pointeur vers un tableau de chaînes (arguments).

Dans ce cas, le seul élément de ce tableau sera un pointeur imbriqué vers l'adresse /bin/sh (pointeur vers pointeur).
RDX, l'argument final, peut être nul.

````
nasm -f elf64 -o shellcode.o shellcode.asm
ld -m elf_x86_64 -s -o shellcode shellcode.o
````

Une fois les opcodes extraits, on peut les copier dans le testeur en C, le compiler et essayer :

````
gcc -m64 -z execstack -fno-stack-protector -o run run.c
````

Puis le lancer.